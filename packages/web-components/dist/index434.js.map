{"version":3,"file":"index434.js","sources":["../../../node_modules/.pnpm/pixi.js@8.8.1/node_modules/pixi.js/lib/rendering/high-shader/compiler/compileHighShader.mjs"],"sourcesContent":["import { addBits } from './utils/addBits.mjs';\nimport { compileHooks } from './utils/compileHooks.mjs';\nimport { compileInputs } from './utils/compileInputs.mjs';\nimport { compileOutputs } from './utils/compileOutputs.mjs';\nimport { injectBits } from './utils/injectBits.mjs';\n\n\"use strict\";\nconst cacheMap = /* @__PURE__ */ Object.create(null);\nconst bitCacheMap = /* @__PURE__ */ new Map();\nlet CACHE_UID = 0;\nfunction compileHighShader({\n  template,\n  bits\n}) {\n  const cacheId = generateCacheId(template, bits);\n  if (cacheMap[cacheId])\n    return cacheMap[cacheId];\n  const { vertex, fragment } = compileInputsAndOutputs(template, bits);\n  cacheMap[cacheId] = compileBits(vertex, fragment, bits);\n  return cacheMap[cacheId];\n}\nfunction compileHighShaderGl({\n  template,\n  bits\n}) {\n  const cacheId = generateCacheId(template, bits);\n  if (cacheMap[cacheId])\n    return cacheMap[cacheId];\n  cacheMap[cacheId] = compileBits(template.vertex, template.fragment, bits);\n  return cacheMap[cacheId];\n}\nfunction compileInputsAndOutputs(template, bits) {\n  const vertexFragments = bits.map((shaderBit) => shaderBit.vertex).filter((v) => !!v);\n  const fragmentFragments = bits.map((shaderBit) => shaderBit.fragment).filter((v) => !!v);\n  let compiledVertex = compileInputs(vertexFragments, template.vertex, true);\n  compiledVertex = compileOutputs(vertexFragments, compiledVertex);\n  const compiledFragment = compileInputs(fragmentFragments, template.fragment, true);\n  return {\n    vertex: compiledVertex,\n    fragment: compiledFragment\n  };\n}\nfunction generateCacheId(template, bits) {\n  return bits.map((highFragment) => {\n    if (!bitCacheMap.has(highFragment)) {\n      bitCacheMap.set(highFragment, CACHE_UID++);\n    }\n    return bitCacheMap.get(highFragment);\n  }).sort((a, b) => a - b).join(\"-\") + template.vertex + template.fragment;\n}\nfunction compileBits(vertex, fragment, bits) {\n  const vertexParts = compileHooks(vertex);\n  const fragmentParts = compileHooks(fragment);\n  bits.forEach((shaderBit) => {\n    addBits(shaderBit.vertex, vertexParts, shaderBit.name);\n    addBits(shaderBit.fragment, fragmentParts, shaderBit.name);\n  });\n  return {\n    vertex: injectBits(vertex, vertexParts),\n    fragment: injectBits(fragment, fragmentParts)\n  };\n}\n\nexport { compileHighShader, compileHighShaderGl };\n//# sourceMappingURL=compileHighShader.mjs.map\n"],"names":["cacheMap","bitCacheMap","CACHE_UID","compileHighShader","template","bits","cacheId","generateCacheId","vertex","fragment","compileInputsAndOutputs","compileBits","compileHighShaderGl","vertexFragments","shaderBit","v","fragmentFragments","compiledVertex","compileInputs","compileOutputs","compiledFragment","highFragment","a","b","vertexParts","compileHooks","fragmentParts","addBits","injectBits"],"mappings":";;;;;AAOA,MAAMA,IAA2B,uBAAO,OAAO,IAAI,GAC7CC,IAA8B,oBAAI;AACxC,IAAIC,IAAY;AAChB,SAASC,EAAkB;AAAA,EACzB,UAAAC;AAAA,EACA,MAAAC;AACF,GAAG;AACD,QAAMC,IAAUC,EAAgBH,GAAUC,CAAI;AAC9C,MAAIL,EAASM,CAAO;AAClB,WAAON,EAASM,CAAO;AACzB,QAAM,EAAE,QAAAE,GAAQ,UAAAC,EAAQ,IAAKC,EAAwBN,GAAUC,CAAI;AACnE,SAAAL,EAASM,CAAO,IAAIK,EAAYH,GAAQC,GAAUJ,CAAI,GAC/CL,EAASM,CAAO;AACzB;AACA,SAASM,EAAoB;AAAA,EAC3B,UAAAR;AAAA,EACA,MAAAC;AACF,GAAG;AACD,QAAMC,IAAUC,EAAgBH,GAAUC,CAAI;AAC9C,SAAIL,EAASM,CAAO,MAEpBN,EAASM,CAAO,IAAIK,EAAYP,EAAS,QAAQA,EAAS,UAAUC,CAAI,IACjEL,EAASM,CAAO;AACzB;AACA,SAASI,EAAwBN,GAAUC,GAAM;AAC/C,QAAMQ,IAAkBR,EAAK,IAAI,CAACS,MAAcA,EAAU,MAAM,EAAE,OAAO,CAACC,MAAM,CAAC,CAACA,CAAC,GAC7EC,IAAoBX,EAAK,IAAI,CAACS,MAAcA,EAAU,QAAQ,EAAE,OAAO,CAACC,MAAM,CAAC,CAACA,CAAC;AACvF,MAAIE,IAAiBC,EAAcL,GAAiBT,EAAS,QAAQ,EAAI;AACzE,EAAAa,IAAiBE,EAAeN,GAAiBI,CAAc;AAC/D,QAAMG,IAAmBF,EAAcF,GAAmBZ,EAAS,UAAU,EAAI;AACjF,SAAO;AAAA,IACL,QAAQa;AAAA,IACR,UAAUG;AAAA,EACd;AACA;AACA,SAASb,EAAgBH,GAAUC,GAAM;AACvC,SAAOA,EAAK,IAAI,CAACgB,OACVpB,EAAY,IAAIoB,CAAY,KAC/BpB,EAAY,IAAIoB,GAAcnB,GAAW,GAEpCD,EAAY,IAAIoB,CAAY,EACpC,EAAE,KAAK,CAACC,GAAGC,MAAMD,IAAIC,CAAC,EAAE,KAAK,GAAG,IAAInB,EAAS,SAASA,EAAS;AAClE;AACA,SAASO,EAAYH,GAAQC,GAAUJ,GAAM;AAC3C,QAAMmB,IAAcC,EAAajB,CAAM,GACjCkB,IAAgBD,EAAahB,CAAQ;AAC3C,SAAAJ,EAAK,QAAQ,CAACS,MAAc;AAC1B,IAAAa,EAAQb,EAAU,QAAQU,GAAaV,EAAU,IAAI,GACrDa,EAAQb,EAAU,UAAUY,GAAeZ,EAAU,IAAI;AAAA,EAC7D,CAAG,GACM;AAAA,IACL,QAAQc,EAAWpB,GAAQgB,CAAW;AAAA,IACtC,UAAUI,EAAWnB,GAAUiB,CAAa;AAAA,EAChD;AACA;","x_google_ignoreList":[0]}
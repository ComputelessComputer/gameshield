{"version":3,"file":"index144.js","sources":["../../game-core/dist/src/games/base-game.js"],"sourcesContent":["/**\n * Base Game Class\n *\n * Abstract base class that all game implementations must extend.\n * Provides common functionality and enforces consistent interface.\n *\n * @packageDocumentation\n */\nimport * as PIXI from 'pixi.js';\nimport { difficultyToValue } from '../utils';\n/**\n * Abstract base class for all games\n */\nexport class BaseGame {\n    /**\n     * Create a new BaseGame instance\n     *\n     * @param app - PIXI Application instance\n     * @param config - Game configuration\n     */\n    constructor(app, config = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        /** Whether the game is currently running */\n        this.isRunning = false;\n        /** Whether the game has been initialized */\n        this.isInitialized = false;\n        /** Game start timestamp */\n        this.startTime = 0;\n        /** Game completion callback */\n        this.onCompleteCallback = null;\n        /** Interaction metrics being collected */\n        this.metrics = {\n            mouseMovements: 0,\n            keyPresses: 0,\n            interactionDuration: 0\n        };\n        this.app = app;\n        this.container = new PIXI.Container();\n        // Set default configuration\n        this.config = {\n            width: (_a = config.width) !== null && _a !== void 0 ? _a : 400,\n            height: (_b = config.height) !== null && _b !== void 0 ? _b : 300,\n            backgroundColor: (_c = config.backgroundColor) !== null && _c !== void 0 ? _c : 0x1099bb,\n            difficulty: (_d = config.difficulty) !== null && _d !== void 0 ? _d : 'medium',\n            assetsPath: (_e = config.assetsPath) !== null && _e !== void 0 ? _e : '',\n            onLoad: (_f = config.onLoad) !== null && _f !== void 0 ? _f : (() => { })\n        };\n        // Convert difficulty to numeric value\n        this.difficultyValue = difficultyToValue(this.config.difficulty);\n        // Add container to stage\n        this.app.stage.addChild(this.container);\n    }\n    /**\n     * Initialize resources and setup\n     */\n    init() {\n        if (this.isInitialized) {\n            return;\n        }\n        // Track interaction metrics\n        this.setupInteractionTracking();\n        // Initialize game-specific elements\n        this.initialize();\n        this.isInitialized = true;\n        // Call onLoad callback if provided\n        if (this.config.onLoad) {\n            this.config.onLoad();\n        }\n    }\n    /**\n     * Set up interaction tracking\n     *\n     * @protected\n     */\n    setupInteractionTracking() {\n        // Track mouse movements within the app view\n        this.app.view.addEventListener('mousemove', () => {\n            if (this.isRunning) {\n                this.metrics.mouseMovements++;\n            }\n        });\n        // Track key presses\n        window.addEventListener('keydown', (e) => {\n            if (this.isRunning) {\n                this.metrics.keyPresses++;\n            }\n        });\n    }\n    /**\n     * Start the game\n     */\n    start() {\n        if (!this.isInitialized) {\n            this.init();\n        }\n        if (this.isRunning) {\n            return;\n        }\n        this.startTime = Date.now();\n        this.isRunning = true;\n        // Reset metrics\n        this.metrics.mouseMovements = 0;\n        this.metrics.keyPresses = 0;\n        this.metrics.interactionDuration = 0;\n    }\n    /**\n     * Pause the game\n     */\n    pause() {\n        this.isRunning = false;\n    }\n    /**\n     * Resume the game\n     */\n    resume() {\n        if (this.isRunning) {\n            return;\n        }\n        this.isRunning = true;\n    }\n    /**\n     * Reset the game state\n     */\n    reset() {\n        this.isRunning = false;\n        this.startTime = 0;\n        // Reset metrics\n        this.metrics.mouseMovements = 0;\n        this.metrics.keyPresses = 0;\n        this.metrics.interactionDuration = 0;\n    }\n    /**\n     * Mount the game to a DOM container\n     *\n     * @param container - HTML element to mount to\n     */\n    mount(container) {\n        // PIXI handles this at a higher level\n        // This is here for API consistency\n    }\n    /**\n     * Set completion callback\n     *\n     * @param callback - Function to call when game completes\n     */\n    setCompletionCallback(callback) {\n        this.onCompleteCallback = callback;\n    }\n    /**\n     * Complete the game and notify with result\n     *\n     * @param success - Whether the game was completed successfully\n     * @param score - Score achieved (0-100)\n     * @param gameData - Optional game-specific data\n     * @protected\n     */\n    complete(success, score, gameData) {\n        if (!this.isRunning) {\n            return;\n        }\n        this.isRunning = false;\n        // Calculate duration\n        const time = Date.now() - this.startTime;\n        this.metrics.interactionDuration = time;\n        // Create result object\n        const result = {\n            success,\n            score,\n            time,\n            metrics: { ...this.metrics },\n            gameData\n        };\n        // Call completion callback if set\n        if (this.onCompleteCallback) {\n            this.onCompleteCallback(result);\n        }\n    }\n    /**\n     * Clean up and destroy game\n     */\n    destroy() {\n        // Remove event listeners\n        this.app.view.removeEventListener('mousemove', () => { });\n        window.removeEventListener('keydown', () => { });\n        // Remove container from stage\n        this.app.stage.removeChild(this.container);\n        // Clean up PIXI resources\n        this.container.destroy({ children: true });\n        // Reset properties\n        this.isInitialized = false;\n        this.isRunning = false;\n        this.onCompleteCallback = null;\n    }\n}\n"],"names":["BaseGame","app","config","_a","_b","_c","_d","_e","_f","PIXI.Container","difficultyToValue","e","container","callback","success","score","gameData","time","result"],"mappings":"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"}
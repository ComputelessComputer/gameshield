{"version":3,"file":"index10.js","sources":["../src/games/pong-game.ts"],"sourcesContent":["import { Game, GameOptions } from '../types';\nimport * as PIXI from 'pixi.js';\n\n/**\n * PongGame\n * \n * A simple Pong game implementation for GameShield CAPTCHA.\n */\nexport class PongGame implements Game {\n  private app: PIXI.Application | null = null;\n  private paddle: PIXI.Graphics | null = null;\n  private ball: PIXI.Graphics | null = null;\n  private aiPaddle: PIXI.Graphics | null = null;\n  private scoreText: PIXI.Text | null = null;\n  private instructionText: PIXI.Text | null = null;\n  \n  private ballVelocity = { x: 0, y: 0 };\n  private score = 0;\n  private targetScore = 3; // Score needed to pass the CAPTCHA\n  private gameStarted = false;\n  private gameEnded = false;\n  \n  private readonly options: GameOptions;\n  \n  constructor(options: GameOptions) {\n    this.options = options;\n    \n    // Adjust difficulty\n    switch (options.difficulty) {\n      case 'easy':\n        this.targetScore = 2;\n        break;\n      case 'medium':\n        this.targetScore = 3;\n        break;\n      case 'hard':\n        this.targetScore = 5;\n        break;\n    }\n  }\n  \n  /**\n   * Mount the game to a container element\n   */\n  public async mount(container: HTMLElement): Promise<void> {\n    // Create PIXI application\n    this.app = new PIXI.Application({\n      width: this.options.width,\n      height: this.options.height,\n      backgroundColor: 0x1a1a1a,\n      resolution: window.devicePixelRatio || 1,\n      antialias: true\n    });\n    \n    // Add the canvas to the container\n    container.appendChild(this.app.view as unknown as HTMLCanvasElement);\n    \n    // Create game elements\n    this.createGameElements();\n    \n    // Add event listeners\n    window.addEventListener('keydown', this.handleKeyDown.bind(this));\n    window.addEventListener('keyup', this.handleKeyUp.bind(this));\n    window.addEventListener('mousemove', this.handleMouseMove.bind(this));\n    \n    // Start game loop\n    this.app.ticker.add(this.gameLoop.bind(this));\n  }\n  \n  /**\n   * Destroy the game and clean up resources\n   */\n  public destroy(): void {\n    if (this.app) {\n      // Remove event listeners\n      window.removeEventListener('keydown', this.handleKeyDown.bind(this));\n      window.removeEventListener('keyup', this.handleKeyUp.bind(this));\n      window.removeEventListener('mousemove', this.handleMouseMove.bind(this));\n      \n      // Destroy PIXI application\n      this.app.destroy(true, { children: true, texture: true, baseTexture: true });\n      this.app = null;\n    }\n    \n    // Reset game state\n    this.paddle = null;\n    this.ball = null;\n    this.aiPaddle = null;\n    this.scoreText = null;\n    this.instructionText = null;\n    this.gameStarted = false;\n    this.gameEnded = false;\n    this.score = 0;\n  }\n  \n  /**\n   * Create game elements\n   */\n  private createGameElements(): void {\n    if (!this.app) return;\n    \n    // Create player paddle\n    this.paddle = new PIXI.Graphics();\n    this.paddle.beginFill(0xffffff);\n    this.paddle.drawRect(0, 0, 100, 10);\n    this.paddle.endFill();\n    this.paddle.x = this.app.screen.width / 2 - 50;\n    this.paddle.y = this.app.screen.height - 20;\n    this.app.stage.addChild(this.paddle);\n    \n    // Create AI paddle\n    this.aiPaddle = new PIXI.Graphics();\n    this.aiPaddle.beginFill(0xff0000);\n    this.aiPaddle.drawRect(0, 0, 100, 10);\n    this.aiPaddle.endFill();\n    this.aiPaddle.x = this.app.screen.width / 2 - 50;\n    this.aiPaddle.y = 20;\n    this.app.stage.addChild(this.aiPaddle);\n    \n    // Create ball\n    this.ball = new PIXI.Graphics();\n    this.ball.beginFill(0xffffff);\n    this.ball.drawCircle(0, 0, 8);\n    this.ball.endFill();\n    this.ball.x = this.app.screen.width / 2;\n    this.ball.y = this.app.screen.height / 2;\n    this.app.stage.addChild(this.ball);\n    \n    // Create score text\n    this.scoreText = new PIXI.Text(`Score: ${this.score}/${this.targetScore}`, {\n      fontFamily: 'Arial',\n      fontSize: 16,\n      fill: 0xffffff\n    });\n    this.scoreText.x = 10;\n    this.scoreText.y = 10;\n    this.app.stage.addChild(this.scoreText);\n    \n    // Create instruction text\n    this.instructionText = new PIXI.Text('Press SPACE to start', {\n      fontFamily: 'Arial',\n      fontSize: 20,\n      fill: 0xffffff\n    });\n    this.instructionText.x = this.app.screen.width / 2 - this.instructionText.width / 2;\n    this.instructionText.y = this.app.screen.height / 2 - 50;\n    this.app.stage.addChild(this.instructionText);\n    \n    // Initialize ball velocity\n    this.resetBall();\n  }\n  \n  /**\n   * Reset ball position and velocity\n   */\n  private resetBall(): void {\n    if (!this.app || !this.ball) return;\n    \n    this.ball.x = this.app.screen.width / 2;\n    this.ball.y = this.app.screen.height / 2;\n    \n    // Random direction, but always moving down toward player\n    const angle = Math.random() * Math.PI / 2 - Math.PI / 4 + Math.PI; // π ± π/4\n    const speed = 5;\n    \n    this.ballVelocity = {\n      x: Math.cos(angle) * speed,\n      y: Math.sin(angle) * speed\n    };\n  }\n  \n  /**\n   * Handle keyboard input\n   */\n  private handleKeyDown(event: KeyboardEvent): void {\n    if (event.code === 'Space' && !this.gameStarted && !this.gameEnded) {\n      this.startGame();\n    }\n  }\n  \n  private handleKeyUp(): void {\n    // Handle key up events if needed\n  }\n  \n  /**\n   * Handle mouse movement for paddle control\n   */\n  private handleMouseMove(event: MouseEvent): void {\n    if (!this.app || !this.paddle) return;\n    \n    const rect = (this.app.view as HTMLCanvasElement).getBoundingClientRect();\n    const relativeX = event.clientX - rect.left;\n    \n    // Move paddle with mouse\n    this.paddle.x = Math.max(0, Math.min(this.app.screen.width - this.paddle.width, relativeX - this.paddle.width / 2));\n  }\n  \n  /**\n   * Start the game\n   */\n  private startGame(): void {\n    if (!this.app || !this.instructionText) return;\n    \n    this.gameStarted = true;\n    this.app.stage.removeChild(this.instructionText);\n    this.instructionText = null;\n  }\n  \n  /**\n   * End the game\n   */\n  private endGame(success: boolean): void {\n    if (!this.app || this.gameEnded) return;\n    \n    this.gameEnded = true;\n    \n    // Create result text\n    const resultText = new PIXI.Text(\n      success ? 'CAPTCHA Passed!' : 'CAPTCHA Failed!',\n      {\n        fontFamily: 'Arial',\n        fontSize: 24,\n        fill: success ? 0x00ff00 : 0xff0000,\n        fontWeight: 'bold'\n      }\n    );\n    \n    resultText.x = this.app.screen.width / 2 - resultText.width / 2;\n    resultText.y = this.app.screen.height / 2 - resultText.height / 2;\n    this.app.stage.addChild(resultText);\n    \n    // Notify completion\n    setTimeout(() => {\n      this.options.onComplete({\n        success,\n        score: this.score\n      });\n    }, 1500);\n  }\n  \n  /**\n   * Game loop\n   */\n  private gameLoop(delta: number): void {\n    if (!this.app || !this.ball || !this.paddle || !this.aiPaddle || !this.scoreText) return;\n    \n    if (!this.gameStarted || this.gameEnded) return;\n    \n    // Move ball\n    this.ball.x += this.ballVelocity.x * delta;\n    this.ball.y += this.ballVelocity.y * delta;\n    \n    // AI paddle movement (follows ball with slight delay)\n    const aiTargetX = this.ball.x - this.aiPaddle.width / 2;\n    this.aiPaddle.x += (aiTargetX - this.aiPaddle.x) * 0.1 * delta;\n    \n    // Keep AI paddle within bounds\n    this.aiPaddle.x = Math.max(0, Math.min(this.app.screen.width - this.aiPaddle.width, this.aiPaddle.x));\n    \n    // Ball collision with walls\n    if (this.ball.x <= 0 || this.ball.x >= this.app.screen.width) {\n      this.ballVelocity.x *= -1;\n    }\n    \n    // Ball collision with top (AI paddle area)\n    if (this.ball.y <= 0) {\n      this.score += 1;\n      this.scoreText.text = `Score: ${this.score}/${this.targetScore}`;\n      this.resetBall();\n      \n      // Check if player has won\n      if (this.score >= this.targetScore) {\n        this.endGame(true);\n      }\n    }\n    \n    // Ball collision with bottom (player loses)\n    if (this.ball.y >= this.app.screen.height) {\n      this.endGame(false);\n    }\n    \n    // Ball collision with AI paddle\n    if (\n      this.ball.y <= this.aiPaddle.y + this.aiPaddle.height &&\n      this.ball.y >= this.aiPaddle.y &&\n      this.ball.x >= this.aiPaddle.x &&\n      this.ball.x <= this.aiPaddle.x + this.aiPaddle.width\n    ) {\n      this.ballVelocity.y *= -1;\n      this.ball.y = this.aiPaddle.y + this.aiPaddle.height;\n      \n      // Add some randomness to the bounce\n      this.ballVelocity.x += (Math.random() - 0.5) * 2;\n    }\n    \n    // Ball collision with player paddle\n    if (\n      this.ball.y >= this.paddle.y - this.ball.height &&\n      this.ball.y <= this.paddle.y + this.paddle.height &&\n      this.ball.x >= this.paddle.x &&\n      this.ball.x <= this.paddle.x + this.paddle.width\n    ) {\n      this.ballVelocity.y *= -1;\n      this.ball.y = this.paddle.y - this.ball.height;\n      \n      // Add some angle based on where the ball hit the paddle\n      const hitPosition = (this.ball.x - this.paddle.x) / this.paddle.width;\n      this.ballVelocity.x = (hitPosition - 0.5) * 10;\n    }\n  }\n}\n"],"names":["PongGame","options","container","PIXI.Application","PIXI.Graphics","PIXI.Text","angle","speed","event","rect","relativeX","success","resultText","delta","aiTargetX","hitPosition"],"mappings":"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"}
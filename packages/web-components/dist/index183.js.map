{"version":3,"file":"index183.js","sources":["../../../node_modules/.pnpm/@pixi+assets@7.4.3_@pixi+core@7.4.3/node_modules/@pixi/assets/lib/loader/parsers/WorkerManager.mjs"],"sourcesContent":["import WorkerInstance from \"../../_virtual/checkImageBitmap.worker.mjs\";\nimport WorkerInstance$1 from \"../../_virtual/loadImageBitmap.worker.mjs\";\nlet UUID = 0, MAX_WORKERS;\nclass WorkerManagerClass {\n  constructor() {\n    this._initialized = !1, this._createdWorkers = 0, this.workerPool = [], this.queue = [], this.resolveHash = {};\n  }\n  isImageBitmapSupported() {\n    return this._isImageBitmapSupported !== void 0 ? this._isImageBitmapSupported : (this._isImageBitmapSupported = new Promise((resolve) => {\n      const { worker } = new WorkerInstance();\n      worker.addEventListener(\"message\", (event) => {\n        worker.terminate(), WorkerInstance.revokeObjectURL(), resolve(event.data);\n      });\n    }), this._isImageBitmapSupported);\n  }\n  loadImageBitmap(src) {\n    return this._run(\"loadImageBitmap\", [src]);\n  }\n  async _initWorkers() {\n    this._initialized || (this._initialized = !0);\n  }\n  getWorker() {\n    MAX_WORKERS === void 0 && (MAX_WORKERS = navigator.hardwareConcurrency || 4);\n    let worker = this.workerPool.pop();\n    return !worker && this._createdWorkers < MAX_WORKERS && (this._createdWorkers++, worker = new WorkerInstance$1().worker, worker.addEventListener(\"message\", (event) => {\n      this.complete(event.data), this.returnWorker(event.target), this.next();\n    })), worker;\n  }\n  returnWorker(worker) {\n    this.workerPool.push(worker);\n  }\n  complete(data) {\n    data.error !== void 0 ? this.resolveHash[data.uuid].reject(data.error) : this.resolveHash[data.uuid].resolve(data.data), this.resolveHash[data.uuid] = null;\n  }\n  async _run(id, args) {\n    await this._initWorkers();\n    const promise = new Promise((resolve, reject) => {\n      this.queue.push({ id, arguments: args, resolve, reject });\n    });\n    return this.next(), promise;\n  }\n  next() {\n    if (!this.queue.length)\n      return;\n    const worker = this.getWorker();\n    if (!worker)\n      return;\n    const toDo = this.queue.pop(), id = toDo.id;\n    this.resolveHash[UUID] = { resolve: toDo.resolve, reject: toDo.reject }, worker.postMessage({\n      data: toDo.arguments,\n      uuid: UUID++,\n      id\n    });\n  }\n}\nconst WorkerManager = new WorkerManagerClass();\nexport {\n  WorkerManager\n};\n//# sourceMappingURL=WorkerManager.mjs.map\n"],"names":["UUID","MAX_WORKERS","WorkerManagerClass","resolve","worker","WorkerInstance","event","src","WorkerInstance$1","data","id","args","promise","reject","toDo","WorkerManager"],"mappings":";;AAEA,IAAIA,IAAO,GAAGC;AACd,MAAMC,EAAmB;AAAA,EACvB,cAAc;AACZ,SAAK,eAAe,IAAI,KAAK,kBAAkB,GAAG,KAAK,aAAa,CAAE,GAAE,KAAK,QAAQ,CAAE,GAAE,KAAK,cAAc;EAC7G;AAAA,EACD,yBAAyB;AACvB,WAAO,KAAK,4BAA4B,SAAS,KAAK,2BAA2B,KAAK,0BAA0B,IAAI,QAAQ,CAACC,MAAY;AACvI,YAAM,EAAE,QAAAC,EAAM,IAAK,IAAIC;AACvB,MAAAD,EAAO,iBAAiB,WAAW,CAACE,MAAU;AAC5C,QAAAF,EAAO,UAAW,GAAEC,EAAe,gBAAiB,GAAEF,EAAQG,EAAM,IAAI;AAAA,MAChF,CAAO;AAAA,IACP,CAAK,GAAG,KAAK;AAAA,EACV;AAAA,EACD,gBAAgBC,GAAK;AACnB,WAAO,KAAK,KAAK,mBAAmB,CAACA,CAAG,CAAC;AAAA,EAC1C;AAAA,EACD,MAAM,eAAe;AACnB,SAAK,iBAAiB,KAAK,eAAe;AAAA,EAC3C;AAAA,EACD,YAAY;AACV,IAAAN,MAAgB,WAAWA,IAAc,UAAU,uBAAuB;AAC1E,QAAIG,IAAS,KAAK,WAAW,IAAG;AAChC,WAAO,CAACA,KAAU,KAAK,kBAAkBH,MAAgB,KAAK,mBAAmBG,IAAS,IAAII,EAAkB,EAAC,QAAQJ,EAAO,iBAAiB,WAAW,CAACE,MAAU;AACrK,WAAK,SAASA,EAAM,IAAI,GAAG,KAAK,aAAaA,EAAM,MAAM,GAAG,KAAK,KAAI;AAAA,IAC3E,CAAK,IAAIF;AAAA,EACN;AAAA,EACD,aAAaA,GAAQ;AACnB,SAAK,WAAW,KAAKA,CAAM;AAAA,EAC5B;AAAA,EACD,SAASK,GAAM;AACb,IAAAA,EAAK,UAAU,SAAS,KAAK,YAAYA,EAAK,IAAI,EAAE,OAAOA,EAAK,KAAK,IAAI,KAAK,YAAYA,EAAK,IAAI,EAAE,QAAQA,EAAK,IAAI,GAAG,KAAK,YAAYA,EAAK,IAAI,IAAI;AAAA,EACxJ;AAAA,EACD,MAAM,KAAKC,GAAIC,GAAM;AACnB,UAAM,KAAK;AACX,UAAMC,IAAU,IAAI,QAAQ,CAACT,GAASU,MAAW;AAC/C,WAAK,MAAM,KAAK,EAAE,IAAAH,GAAI,WAAWC,GAAM,SAAAR,GAAS,QAAAU,EAAM,CAAE;AAAA,IAC9D,CAAK;AACD,WAAO,KAAK,KAAM,GAAED;AAAA,EACrB;AAAA,EACD,OAAO;AACL,QAAI,CAAC,KAAK,MAAM;AACd;AACF,UAAMR,IAAS,KAAK;AACpB,QAAI,CAACA;AACH;AACF,UAAMU,IAAO,KAAK,MAAM,IAAG,GAAIJ,IAAKI,EAAK;AACzC,SAAK,YAAYd,CAAI,IAAI,EAAE,SAASc,EAAK,SAAS,QAAQA,EAAK,UAAUV,EAAO,YAAY;AAAA,MAC1F,MAAMU,EAAK;AAAA,MACX,MAAMd;AAAA,MACN,IAAAU;AAAA,IACN,CAAK;AAAA,EACF;AACH;AACK,MAACK,IAAgB,IAAIb,EAAkB;","x_google_ignoreList":[0]}